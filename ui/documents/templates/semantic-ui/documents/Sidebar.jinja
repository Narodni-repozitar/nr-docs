{#def metadata, record, extra_context, is_preview, api_record #}
{%set recordRequests = record.expanded.requests and record.expanded.requests|selectattr('status_code', 'in',
['submitted', 'created'])|list%}
{% if record.expanded.request_types or recordRequests or record.links.edit_html %}
<RecordActions record={record} permissions={extra_context.permissions}
  groups_enabled={config.USERS_RESOURCES_GROUPS_ENABLED} />
{% endif %}
{% if record.expanded.communities %}
<RecordCommunities communities={record.expanded.communities} />
{% endif %}
<IdentifiersAndLinks originalRecordUrl={metadata.originalRecord} objectIdentifiers={metadata.objectIdentifiers}
  pids={record.get('pids', {})} />
<Metrics record={api_record} />

{% if "oai" not in record
or "harvest" not in record.oai
or "identifier" not in record.oai.harvest
%}
{# do not show the versions for harvested records #}
<RecordVersions record={record} is_preview={is_preview} />
{% endif %}

<RecordCitations record={record} styles={config.get("CITATION_STYLES")}
  defaultStyle={config.get("CITATION_STYLES_DEFAULT")} />
<RecordExport record={record} metadata={metadata} extra_context={extra_context} />