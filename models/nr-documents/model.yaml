$defs:
  use:
  - ./definitions.yaml
profiles:
- record
- draft
record:
  module:
    qualified: nr_documents
  extend: nr-documents#DocumentModel
  permissions:
    presets:
    - authenticated
  pid:
    type: dcmnts
  properties:
    metadata:
      properties: {}
  service-config:
    base-classes: [ PermissionsPresetsConfigMixin, FilteredResultServiceConfig ]
    imports:
      - import: nr_docs_extensions.services.config.FilteredResultServiceConfig
      - import: oarepo_runtime.config.service.PermissionsPresetsConfigMixin
      # this was not merged from requests/service-config. Why??
      - import: oarepo_requests.components.requests.PublishDraftComponent
  json-serializer:
    base-classes: [ FilteredUIJSONSerializer ]
    imports:
      - import: nr_docs_extensions.services.filtered_json_ui_serializer.FilteredUIJSONSerializer
      - import: flask_resources.serializers.JSONSerializer
      - import: flask_resources.BaseListSchema
      - import: flask_resources.MarshmallowSerializer
  resource-config:
    base-html-url: /docs/
  search-options:
    base-classes:
      - InvenioSearchOptions
    imports:
      - import: oarepo_runtime.services.icu.SearchOptions
        alias: InvenioSearchOptions

  # sort by czech title
  record:
    imports:
      - import: oarepo_runtime.records.SystemFieldDumperExt
      - import: nr_docs_extensions.services.sort.LangValueICUSortField
      - import: invenio_drafts_resources.records.api.Record
        alias: InvenioRecord
    extra-code: |-2
          # extra custom fields for sorting by title
          sort = LangValueICUSortField(source_field="metadata.title")
  record-dumper:
    extensions:
      - SystemFieldDumperExt()

  draft: {}
  use:
  - invenio
  - ./custom_fields.yaml
  - ./requests.yaml
plugins:
  builder:
    disable:
    - script_sample_data
  packages:
  - oarepo-model-builder-nr
  - oarepo-model-builder-ui
  - oarepo-model-builder-files==4.*
  - oarepo-model-builder-cf==4.*
  - oarepo-model-builder-vocabularies==4.*
  - oarepo-model-builder-relations==4.*
  - oarepo-model-builder-requests
  - oarepo-model-builder-drafts
runtime-dependencies:
  nr-metadata: 1.0.0
  nr-oaipmh-harvesters: 1.0.0
  nr-vocabularies: 1.0.0
settings:
  i18n-languages:
  - cs
  - en
  supported-langs:
    cs:
      keyword:
        type: keyword
      text:
        analyzer: czech
    en:
      text: {}
